apiVersion: install.istio.io/v1alpha1
kind: IstioOperator
metadata:
  namespace: istio-system
  name: istiocontrolplane
spec:
  profile: default
  components:
    ingressGateways:
      enabled: true
      k8s:
        affinity: # note this doesn't work yet (https://github.com/istio/istio/pull/22067)
          nodeAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
              nodeSelectorTerms:
                - matchExpressions:
                    - key: ingress-ready
                      operator: In
                      values:
                        - true
