apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: doc-index-updater
  namespace: doc-index-updater
spec:
  hosts:
    - doc-index-updater.non-prod.mhra.gov.uk
  gateways:
    - istio-system/doc-index-updater-non-prod-ingressgateway
    - istio-system/doc-index-updater-test-ingressgateway
  http:
    - route:
        - destination:
            port:
              number: 80
            host: doc-index-updater
      corsPolicy:
        allowOrigin:
          - non-prod.mhra.gov.uk
          - test.mhra.gov.uk
          - mhraparsnonprod.azureedge.net
          - mhraparsnonprod.z33.web.core.windows.net
        allowMethods:
          - POST
        allowCredentials: false
        allowHeaders:
          - Authorization
        maxAge: "24h"
